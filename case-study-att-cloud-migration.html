<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AT&amp;T Business Intelligence &amp; Self-Service Analytics Platform - Portfolio | Pamela Austin</title>
    <link rel="stylesheet" href="case-study-styles.css">
    <style>
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .team-member {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .team-member h4 {
            margin: 10px 0 5px 0;
            font-size: 1.1em;
        }

        .team-member p {
            margin: 5px 0;
            font-size: 0.9em;
            opacity: 0.9;
        }

        .system-flow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 40px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .system-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px 20px;
            border-radius: 15px;
            color: white;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }

        .system-box:hover {
            transform: translateY(-5px);
        }

        .system-box.destination {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-width: 200px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .arrow {
            font-size: 2em;
            color: #667eea;
            margin: 0 10px;
        }

        .kpi-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .kpi-card {
            background: white;
            border-left: 5px solid #667eea;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .kpi-card.success {
            border-left-color: #10b981;
        }

        .kpi-card.warning {
            border-left-color: #f59e0b;
        }

        .kpi-card.info {
            border-left-color: #3b82f6;
        }

        .kpi-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #1e293b;
            margin: 10px 0;
        }

        .kpi-label {
            color: #64748b;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .kpi-change {
            color: #10b981;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }

        .tech-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .optimization-section {
            background: linear-gradient(135deg, #f6f8fb 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            max-width: 1200px;
        }

        .metric-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .metric-column {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .metric-column h4 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .metric-column.before h4 {
            color: #ef4444;
        }

        .metric-column.after h4 {
            color: #10b981;
        }

        .metric-column ul {
            color: #1f2937;
            line-height: 1.8;
        }

        .metric-column ul li {
            margin-bottom: 0.5rem;
        }

        /* Dark mode for optimization section */
        body.dark-mode .optimization-section {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }

        body.dark-mode .metric-column {
            background: #1e293b;
            border: 1px solid #475569;
        }

        body.dark-mode .metric-column h4 {
            color: inherit;
        }

        body.dark-mode .metric-column.before h4 {
            color: #f87171;
        }

        body.dark-mode .metric-column.after h4 {
            color: #34d399;
        }

        body.dark-mode .metric-column ul {
            color: #e5e7eb;
        }

        body.dark-mode .milestone-content {
            background: #1e293b;
            border: 1px solid #475569;
            color: #e5e7eb;
        }

        body.dark-mode .milestone-date {
            color: #a78bfa;
        }

        .milestone-timeline {
            position: relative;
            padding: 20px 0;
            margin: 30px 0;
        }

        .milestone {
            position: relative;
            padding-left: 40px;
            margin-bottom: 30px;
        }

        .milestone::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 5px;
            width: 15px;
            height: 15px;
            background: #667eea;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 2px #667eea;
        }

        .milestone::after {
            content: '';
            position: absolute;
            left: 17px;
            top: 20px;
            width: 2px;
            height: calc(100% + 10px);
            background: #e2e8f0;
        }

        .milestone:last-child::after {
            display: none;
        }

        .milestone-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .milestone-date {
            color: #667eea;
            font-weight: bold;
            font-size: 0.9em;
        }

        /* Personal Analyst Notes Styles */
        .analyst-note {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 5px solid #f59e0b;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .analyst-note::before {
            content: '📝 Team Story';
            font-weight: 700;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #92400e;
            display: block;
            margin-bottom: 0.75rem;
        }

        .analyst-note p {
            margin: 0.5rem 0;
            font-size: 1rem;
            line-height: 1.7;
            color: #1f2937;
        }

        .analyst-note strong {
            color: #92400e;
            font-weight: 600;
        }

        .aha-moment {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-left: 5px solid #3b82f6;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .aha-moment::before {
            content: '💡 Technical Breakthrough!';
            font-weight: 700;
            font-size: 1rem;
            color: #1e40af;
            display: block;
            margin-bottom: 0.75rem;
        }

        .aha-moment p {
            margin: 0.5rem 0;
            font-size: 1rem;
            line-height: 1.7;
            color: #1f2937;
        }

        .aha-moment strong {
            color: #1e40af;
            font-weight: 600;
        }

        .thought-process {
            background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
            border-left: 5px solid #a855f7;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .thought-process::before {
            content: '🤔 Challenge Faced...';
            font-weight: 700;
            font-size: 1rem;
            color: #7e22ce;
            display: block;
            margin-bottom: 0.75rem;
        }

        .thought-process p {
            margin: 0.5rem 0;
            font-size: 1rem;
            line-height: 1.7;
            color: #1f2937;
        }

        .thought-process strong {
            color: #7e22ce;
            font-weight: 600;
        }

        /* Dark mode styles for personal notes - using solid colors for better contrast */
        body.dark-mode .analyst-note {
            background: linear-gradient(135deg, #134e4a 0%, #115e59 100%);
            border-left-color: #2dd4bf;
        }

        body.dark-mode .analyst-note::before {
            color: #5eead4;
        }

        body.dark-mode .analyst-note p {
            color: #ccfbf1;
        }

        body.dark-mode .analyst-note strong {
            color: #5eead4;
        }

        body.dark-mode .aha-moment {
            background: linear-gradient(135deg, #78350f 0%, #92400e 100%);
            border-left-color: #fbbf24;
        }

        body.dark-mode .aha-moment::before {
            color: #fde68a;
        }

        body.dark-mode .aha-moment p {
            color: #fef3c7;
        }

        body.dark-mode .aha-moment strong {
            color: #fde68a;
        }

        body.dark-mode .thought-process {
            background: linear-gradient(135deg, #581c87 0%, #6b21a8 100%);
            border-left-color: #c084fc;
        }

        body.dark-mode .thought-process::before {
            color: #e9d5ff;
        }

        body.dark-mode .thought-process p {
            color: #f3e8ff;
        }

        body.dark-mode .thought-process strong {
            color: #e9d5ff;
        }

        /* Navigation styles */
        .case-study-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: var(--bg-white);
            border-bottom: 2px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            color: var(--primary-color);
            transform: translateX(-4px);
        }

        .theme-toggle-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-white);
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .theme-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
        }

        /* Header styling to match notebook style */
        .case-study-header {
            padding: 3rem 2rem;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: 12px;
            margin-bottom: 2rem;
            border-left: 4px solid #667eea;
            width: 100%;
            box-sizing: border-box;
        }

        body.dark-mode .case-study-header {
            background: linear-gradient(135deg, rgba(167, 139, 250, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
            border-left-color: #a78bfa;
        }

        .case-study-header .header-content {
            width: 100%;
        }

        .case-study-header .project-tag {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: var(--primary-color);
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .case-study-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .case-study-header .project-subtitle {
            color: var(--text-gray);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        /* Content width constraints */
        .case-study-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .content-section {
            margin-bottom: 3rem;
        }

        /* Data mapping table styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        thead {
            background: #667eea;
            color: white;
        }

        th {
            padding: 10px;
            text-align: left;
            font-weight: 600;
        }

        tbody {
            background: white;
        }

        tbody tr {
            border-bottom: 1px solid #ddd;
        }

        td {
            padding: 10px;
            color: #1f2937;
        }

        td code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
            color: #667eea;
        }

        /* Dark mode for tables */
        body.dark-mode thead {
            background: #667eea;
        }

        body.dark-mode tbody {
            background: #1e293b;
        }

        body.dark-mode tbody tr {
            border-bottom: 1px solid #475569;
        }

        body.dark-mode td {
            color: #e5e7eb;
        }

        body.dark-mode td code {
            background: #334155;
            color: #a78bfa;
        }

        /* Challenge-Solution styling */
        .challenge-solution {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            border-left: 4px solid var(--primary-color);
        }

        .challenge-solution h3 {
            color: var(--text-dark);
            margin-bottom: 2rem;
            font-size: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .challenge-solution > div {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: start;
        }

        .challenge-solution p {
            margin: 0;
            padding: 1.5rem;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-white);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            min-height: 120px;
        }

        .challenge-solution p strong {
            color: var(--primary-color);
            font-size: 1.15rem;
            display: block;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--primary-color);
        }

        body.dark-mode .challenge-solution {
            background: #1e293b;
            border-left-color: #a78bfa;
        }

        body.dark-mode .challenge-solution h3 {
            color: #e5e7eb;
            border-bottom-color: #475569;
        }

        body.dark-mode .challenge-solution p {
            color: #d1d5db;
            background: #0f172a;
            border-color: #475569;
        }

        body.dark-mode .challenge-solution p strong {
            color: #a78bfa;
            border-bottom-color: #a78bfa;
        }

        /* Results grid - 2x2 layout */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin: 2rem 0;
        }

        .result-card {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .result-card h3 {
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .result-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .result-card ul li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.75rem;
            line-height: 1.5;
            color: var(--text-dark);
            font-size: 0.95rem;
            text-align: left;
        }

        .result-card ul li::before {
            content: "•";
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.2rem;
            margin-right: 0.75rem;
            flex-shrink: 0;
            line-height: 1.5;
            min-width: 1.2rem;
            text-align: center;
        }

        body.dark-mode .result-card {
            background: #1e293b;
            border-left-color: #a78bfa;
        }

        body.dark-mode .result-card h3 {
            color: #e5e7eb;
        }

        body.dark-mode .result-card ul li {
            color: #d1d5db;
        }

        body.dark-mode .result-card ul li::before {
            color: #a78bfa;
        }

        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .challenge-solution > div {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .challenge-solution p {
                min-height: auto;
            }
        }

        @media (max-width: 768px) {
            .metric-comparison {
                grid-template-columns: 1fr;
            }

            .system-flow {
                flex-direction: column;
            }

            .arrow {
                transform: rotate(90deg);
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="case-study-nav">
        <a href="index.html" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Portfolio
        </a>
        <button class="theme-toggle-btn" id="themeToggle" aria-label="Toggle Theme">
            <i class="fas fa-moon"></i>
        </button>
    </nav>

    <header class="case-study-header">
        <div class="header-content">
            <span class="project-tag">Business Intelligence &middot; Power BI &middot; Snowflake</span>
            <h1>AT&amp;T Business Intelligence &amp; Self-Service Analytics Platform</h1>
            <p class="project-subtitle">25+ Power BI Dashboards &middot; 45s &rarr; 3s Query Optimization &middot; 150+ Self-Service Users &middot; 60% IT Request Reduction</p>
        </div>
    </header>

    <main class="case-study-content">

        <!-- Executive Summary -->
        <section class="content-section">
            <h2>Executive Summary</h2>
            <p>Built AT&amp;T Marketing Operations' Business Intelligence platform, consolidating data from Workfront (project management), Salesforce (CRM), and ZoomInfo (contact data) via Fivetran into Snowflake and powering self-service analytics for <strong>150+ users</strong>. Designed and built <strong>25+ Power BI dashboards</strong> for executive leadership tracking campaign performance, workforce costs, budget allocations, and operational KPIs. Developed DAX measures for YoY growth, rolling averages, cohort analysis, and variance-to-budget calculations. Reduced dashboard query times from <strong>45 seconds to 3 seconds</strong> (93% improvement) through optimized dimensional models. Reduced IT data request tickets by <strong>60%</strong> and manual data retrieval by <strong>40%</strong>.</p>

            <div class="analyst-note">
                <p><strong>The Problem Statement:</strong> When I joined AT&amp;T's Marketing Technology team in March 2024, the analytics workflow was entirely manual. Campaign managers exported data from Workfront, pasted it into Excel, manually joined it with Salesforce exports, and produced reports that were outdated by the time they were distributed. 200+ concurrent campaigns, zero single source of truth.</p>
                <p><strong>The Decision:</strong> Rather than building another one-off dashboard, I proposed a proper BI platform: a unified Snowflake reporting layer fed by Fivetran, with a Power BI semantic layer on top enabling self-service analytics. The key question was always "who is consuming this data and what decisions are they making?" — every dimension, every measure, and every dashboard layout was designed with the business user in mind first.</p>
                <p><strong>The Result:</strong> 12 months later: 25+ Power BI dashboards in production, 150+ self-service users, and the analytics team no longer spends 40% of their time pulling data manually.</p>
            </div>

            <div class="highlight-box">
                <h3>Key Outcomes</h3>
                <ul>
                    <li><strong>25+ Power BI dashboards</strong> deployed to production for executive leadership</li>
                    <li><strong>150+ self-service users</strong> on Power BI &mdash; up from a team of 3 analysts</li>
                    <li><strong>60% reduction</strong> in IT data request tickets</li>
                    <li><strong>40% reduction</strong> in manual data retrieval across marketing operations</li>
                    <li><strong>45s &rarr; 3s</strong> Power BI query latency improvement (query optimization)</li>
                    <li><strong>200+ concurrent campaigns</strong> tracked via incremental dbt models</li>
                </ul>
            </div>
        </section>

        <!-- System Architecture -->
        <section class="content-section">
            <h2>BI Platform Architecture</h2>
            <div class="system-flow">
                <div class="system-box">
                    <h3>Workfront</h3>
                    <p>Project Tasks<br>Timelines<br>Resource Plans</p>
                </div>
                <span class="arrow">&rarr;</span>
                <div class="system-box">
                    <h3>Salesforce</h3>
                    <p>CRM Contacts<br>Opportunities<br>Account Data</p>
                </div>
                <span class="arrow">&rarr;</span>
                <div class="system-box">
                    <h3>ZoomInfo</h3>
                    <p>Company Data<br>Contact Enrichment<br>Intent Signals</p>
                </div>
                <span class="arrow">&rarr;</span>
                <div class="system-box destination">
                    <h3>Fivetran &rarr; Snowflake &rarr; dbt</h3>
                    <p>Analytics Engineering Platform</p>
                </div>
            </div>
            <p>Fivetran syncs all three sources into Snowflake raw schemas on a scheduled cadence. dbt staging models clean and normalize the raw data; intermediate models apply business logic (campaign attribution, SCD Type 2 organizational tracking, date spine joins); mart models produce the final star schema consumed by Power BI.</p>
        </section>

        <!-- KPI Dashboard -->
        <section class="content-section">
            <h2>Key Performance Indicators</h2>
            <div class="kpi-dashboard">
                <div class="kpi-card success">
                    <div class="kpi-label">dbt Models Deployed</div>
                    <div class="kpi-value">80+</div>
                    <div class="kpi-change">&uarr; Staging / Int / Marts</div>
                </div>

                <div class="kpi-card success">
                    <div class="kpi-label">Query Latency</div>
                    <div class="kpi-value">45s &rarr; 3s</div>
                    <div class="kpi-change">&uarr; 93% improvement</div>
                </div>

                <div class="kpi-card success">
                    <div class="kpi-label">Self-Service Users</div>
                    <div class="kpi-value">150+</div>
                    <div class="kpi-change">&uarr; Power BI consumers</div>
                </div>

                <div class="kpi-card success">
                    <div class="kpi-label">IT Request Reduction</div>
                    <div class="kpi-value">60%</div>
                    <div class="kpi-change">&uarr; Tickets eliminated</div>
                </div>

                <div class="kpi-card neutral">
                    <div class="kpi-label">Manual Data Reduction</div>
                    <div class="kpi-value">40%</div>
                    <div class="kpi-change">Hours reclaimed weekly</div>
                </div>

                <div class="kpi-card neutral">
                    <div class="kpi-label">Campaigns Tracked</div>
                    <div class="kpi-value">200+</div>
                    <div class="kpi-change">Incremental models</div>
                </div>
            </div>
        </section>

        <!-- Technical Deep Dive -->
        <section class="content-section">
            <h2>Technical Deep Dive</h2>

            <h3>Dimensional Data Model Architecture</h3>
            <div class="metric-comparison">
                <div class="metric-box comparison">
                    <h4>Before: Manual Process</h4>
                    <ul>
                        <li>Workfront CSV exports &rarr; manual Excel joins</li>
                        <li>Salesforce reports downloaded ad hoc</li>
                        <li>No version control, no lineage, no tests</li>
                        <li>3 analysts spending 40% of time on data prep</li>
                        <li>Power BI queries timing out at 45+ seconds</li>
                        <li>Each team had its own definition of "active campaign"</li>
                    </ul>
                </div>
                <div class="metric-box comparison">
                    <h4>After: dbt + Snowflake Platform</h4>
                    <ul>
                        <li>Fivetran &rarr; Snowflake raw &rarr; dbt staging models</li>
                        <li>Intermediate models: business logic, SCD Type 2, attribution</li>
                        <li>Mart models: star schema facts + conformed dimensions</li>
                        <li>150+ users consuming self-service Power BI</li>
                        <li>Sub-3-second query performance via Snowflake clustering</li>
                        <li>Single conformed definition for every business concept</li>
                    </ul>
                </div>
            </div>

            <h3>Incremental Models for Campaign Data</h3>
            <p>With 200+ concurrent campaigns producing daily volume metrics, full-refresh models were impractical. Each incremental dbt model uses a <code>unique_key</code> composite (campaign_id + date) and a <code>max(updated_at)</code> filter &rarr; meaning only new or changed records are processed per run. This pattern scaled campaign fact tables to handle daily Workfront sync without warehouse timeouts.</p>

            <div class="code-block">
                <h4>dbt Incremental Model &rarr; fct_campaign_daily.sql:</h4>
                <pre><code>-- models/marts/marketing/fct_campaign_daily.sql
-- Incremental model: processes only new/updated campaign records each run
-- Grain: one row per campaign per day

{{
    config(
        materialized='incremental',
        unique_key='campaign_day_key',
        on_schema_change='sync_all_columns',
        cluster_by=['campaign_date', 'department_key']
    )
}}

with workfront_tasks as (
    select * from {{ ref('int_workfront_tasks_normalized') }}
    {% if is_incremental() %}
        where updated_at > (select max(loaded_at) from {{ this }})
    {% endif %}
),

salesforce_campaigns as (
    select * from {{ ref('int_salesforce_campaigns_active') }}
),

date_spine as (
    -- reusable macro: generates daily date records for a rolling window
    {{ dbt_utils.date_spine(
        datepart   = "day",
        start_date = "cast('2024-01-01' as date)",
        end_date   = "current_date()"
    ) }}
),

campaign_daily as (
    select
        {{ dbt_utils.generate_surrogate_key([
            'wt.campaign_id', 'ds.date_day'
        ]) }}                                               as campaign_day_key,

        ds.date_day                                         as campaign_date,
        wt.campaign_id,
        wt.campaign_name,
        wt.department_key,
        wt.owner_employee_key,
        sc.campaign_type,
        sc.budget_amount,

        -- calculated daily metrics
        sum(wt.planned_hours)                               as planned_hours_day,
        sum(wt.actual_hours)                                as actual_hours_day,
        count(distinct wt.task_id)                          as task_count,
        count(distinct case when wt.status = 'COMPLETE'
              then wt.task_id end)                          as tasks_completed,

        -- budget variance
        coalesce(sc.budget_amount, 0) -
            coalesce(sc.actual_spend_to_date, 0)            as budget_variance,

        current_timestamp()                                 as loaded_at

    from date_spine ds
    join workfront_tasks wt
        on ds.date_day between wt.planned_start_date and wt.planned_end_date
    left join salesforce_campaigns sc
        on wt.campaign_id = sc.campaign_id

    group by 1,2,3,4,5,6,7,8
)

select * from campaign_daily</code></pre>
            </div>

            <h3>SCD Type 2 &rarr; Organizational Change Tracking</h3>
            <p>AT&T underwent multiple reorganizations during 2024. Department hierarchies, team assignments, and campaign ownership changed frequently. Rather than overwrite historical records, I implemented SCD Type 2 in a dbt macro to track changes with <code>valid_from</code> / <code>valid_to</code> effective dates, allowing Power BI to report on "who owned what, when" across reorg timelines.</p>

            <div class="code-block">
                <h4>dbt Macro &rarr; scd_type_2.sql (reusable across all dimensions):</h4>
                <pre><code>-- macros/scd_type_2.sql
-- Tracks slowly changing dimension changes with effective dating
-- Usage: {{ scd_type_2(source_model='stg_salesforce_accounts', natural_key='account_id', tracked_columns=['department', 'owner_id', 'territory']) }}

{% macro scd_type_2(source_model, natural_key, tracked_columns) %}

with source as (
    select * from {{ ref(source_model) }}
),

changes_detected as (
    select
        {{ natural_key }},
        {% for col in tracked_columns %}
        {{ col }},
        {% endfor %}
        updated_at,

        -- hash all tracked columns to detect any change
        md5(concat_ws('|',
            {% for col in tracked_columns %}
            coalesce(cast({{ col }} as varchar), 'NULL')
            {{ ',' if not loop.last }}
            {% endfor %}
        ))                                              as row_hash,

        lag(md5(concat_ws('|',
            {% for col in tracked_columns %}
            coalesce(cast({{ col }} as varchar), 'NULL')
            {{ ',' if not loop.last }}
            {% endfor %}
        ))) over (partition by {{ natural_key }}
                  order by updated_at)                  as prev_row_hash

    from source
),

versioned as (
    select
        *,
        updated_at                                      as valid_from,
        coalesce(
            lead(updated_at) over (partition by {{ natural_key }}
                                   order by updated_at),
            '9999-12-31'::date
        )                                               as valid_to,
        case when lead(updated_at) over (partition by {{ natural_key }}
                                         order by updated_at) is null
             then true else false end                   as is_current

    from changes_detected
    where row_hash != coalesce(prev_row_hash, '')
       or prev_row_hash is null
)

select * from versioned

{% endmacro %}</code></pre>
            </div>

            <div class="surprise-finding">
                <h4>The Discovery That Prompted a 60% IT Ticket Reduction</h4>
                <p>Three months into building the dbt platform, I analyzed the IT data request queue. Of the 400+ monthly tickets, 62% were variations of the same five questions: "How many campaigns are active right now?", "What's the budget utilization for Q3?", "Which campaigns are overrunning?", "Who owns Salesforce account X?", "What's the forecast for Y campaign?" Every analyst was asking the same questions independently because there was no shared, trusted dataset. I built five mart models directly targeting these questions and published them to Power BI. The next month, the same five question types disappeared from the ticket queue entirely. The 60% IT request reduction wasn't a feature &mdash; it was a natural byproduct of having a single source of truth that people could access themselves. That experience crystallized why analytics engineering matters: it's not about building dashboards. It's about eliminating the need to ask.</p>
            </div>
        </section>

        <!-- Results -->
        <section class="content-section">
            <h2>Results &amp; Business Impact</h2>

            <div class="kpi-dashboard">
                <div class="kpi-card success">
                    <div class="kpi-label">Manual Data Work Eliminated</div>
                    <div class="kpi-value">40%</div>
                    <div class="kpi-change">Hours reclaimed in marketing ops</div>
                </div>
                <div class="kpi-card success">
                    <div class="kpi-label">Self-Service Power BI Users</div>
                    <div class="kpi-value">150+</div>
                    <div class="kpi-change">Up from 3 analysts</div>
                </div>
                <div class="kpi-card success">
                    <div class="kpi-label">IT Request Tickets</div>
                    <div class="kpi-value">-60%</div>
                    <div class="kpi-change">Monthly ticket reduction</div>
                </div>
                <div class="kpi-card success">
                    <div class="kpi-label">Query Performance</div>
                    <div class="kpi-value">45s &rarr; 3s</div>
                    <div class="kpi-change">Power BI dashboard loads</div>
                </div>
            </div>

            <h3>Technologies &amp; Tools</h3>
            <div class="tech-grid">
                <div class="tech-category-block">
                    <h4>BI &amp; Data Modeling (Core)</h4>
                    <div class="tech-badges">
                        <span class="tech-badge">dbt Core</span>
                        <span class="tech-badge">dbt Incremental Models</span>
                        <span class="tech-badge">dbt Macros</span>
                        <span class="tech-badge">dbt Tests</span>
                        <span class="tech-badge">dbt Docs</span>
                        <span class="tech-badge">SCD Type 2</span>
                        <span class="tech-badge">dbt-utils</span>
                    </div>
                </div>
                <div class="tech-category-block">
                    <h4>Data Infrastructure</h4>
                    <div class="tech-badges">
                        <span class="tech-badge">Snowflake</span>
                        <span class="tech-badge">Fivetran</span>
                        <span class="tech-badge">Workfront</span>
                        <span class="tech-badge">Salesforce</span>
                        <span class="tech-badge">ZoomInfo</span>
                        <span class="tech-badge">GitHub Actions</span>
                    </div>
                </div>
                <div class="tech-category-block">
                    <h4>BI &amp; Analytics</h4>
                    <div class="tech-badges">
                        <span class="tech-badge">Power BI</span>
                        <span class="tech-badge">DAX</span>
                        <span class="tech-badge">Power Query</span>
                        <span class="tech-badge">SQL (Advanced)</span>
                        <span class="tech-badge">Python</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation -->
        <section class="content-section">
            <div class="navigation-buttons">
                <a href="index.html" class="nav-button">&larr; Back to Portfolio</a>
                <a href="case-study-att-ml.html" class="nav-button primary">AT&T ML Forecasting &rarr;</a>
            </div>
        </section>
    </main>

    <footer class="case-study-footer">
        <div class="disclaimer">
            <p><i class="fas fa-shield-alt"></i> <strong>Disclaimer:</strong> This project presents composite scenarios and illustrative metrics based on professional experience. Specific numbers and examples are representative and do not reflect actual confidential data from any employer or client.</p>
        </div>
        <p>&copy; 2025 Pamela Austin. All rights reserved.</p>
    </footer>

    <script>
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        const icon = themeToggle.querySelector('i');

        // Check saved theme
        const darkMode = localStorage.getItem('darkMode');
        if (darkMode === 'enabled') {
            body.classList.add('dark-mode');
            icon.classList.remove('fa-moon');
            icon.classList.add('fa-sun');
        }

        themeToggle.addEventListener('click', function() {
            body.classList.toggle('dark-mode');
            
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                localStorage.setItem('darkMode', 'disabled');
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        });
    </script>
</body>
</html>
