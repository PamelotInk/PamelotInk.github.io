<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project: M&A Financial Data Integration & Automation Platform - Signet Jewelers</title>
    <link rel="stylesheet" href="case-study-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Personal Analyst Note Styles */
        .analyst-note {
            background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
            border-left: 4px solid #14b8a6;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        .analyst-note h4 {
            color: #0d7377;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .analyst-note h4::before {
            content: "üìù";
        }
        .analyst-note p {
            color: #1a5f5f;
            line-height: 1.7;
            margin: 0;
        }

        .aha-moment {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        .aha-moment h4 {
            color: #b45309;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .aha-moment h4::before {
            content: "üí°";
        }
        .aha-moment p {
            color: #92400e;
            line-height: 1.7;
            margin: 0;
        }

        .thought-process {
            background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
            border-left: 4px solid #8b5cf6;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        .thought-process h4 {
            color: #6d28d9;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .thought-process h4::before {
            content: "üß†";
        }
        .thought-process p {
            color: #5b21b6;
            line-height: 1.7;
            margin: 0;
        }

        .surprise-finding {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            border-left: 4px solid #ec4899;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        .surprise-finding h4 {
            color: #be185d;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .surprise-finding h4::before {
            content: "üíé";
        }
        .surprise-finding p {
            color: #9d174d;
            line-height: 1.7;
            margin: 0;
        }

        /* Dark mode styles - using solid colors for better contrast */
        body.dark-mode .analyst-note {
            background: linear-gradient(135deg, #134e4a 0%, #115e59 100%);
            border-left-color: #2dd4bf;
        }
        body.dark-mode .analyst-note h4 {
            color: #5eead4;
        }
        body.dark-mode .analyst-note p {
            color: #ccfbf1;
        }

        body.dark-mode .aha-moment {
            background: linear-gradient(135deg, #78350f 0%, #92400e 100%);
            border-left-color: #fbbf24;
        }
        body.dark-mode .aha-moment h4 {
            color: #fde68a;
        }
        body.dark-mode .aha-moment p {
            color: #fef3c7;
        }

        body.dark-mode .thought-process {
            background: linear-gradient(135deg, #581c87 0%, #6b21a8 100%);
            border-left-color: #c084fc;
        }
        body.dark-mode .thought-process h4 {
            color: #e9d5ff;
        }
        body.dark-mode .thought-process p {
            color: #f3e8ff;
        }

        body.dark-mode .surprise-finding {
            background: linear-gradient(135deg, #831843 0%, #9d174d 100%);
            border-left-color: #f472b6;
        }
        body.dark-mode .surprise-finding h4 {
            color: #fbcfe8;
        }
        body.dark-mode .surprise-finding p {
            color: #fce7f3;
        }
        
        /* Dark mode for SVG charts - lines and strokes */
        body.dark-mode svg line[stroke="#e5e7eb"] { stroke: #475569 !important; }
        body.dark-mode svg circle[stroke="#e5e7eb"] { stroke: #475569 !important; }
    </style>
</head>
<body>
    <script>
        // Check for dark mode preference on page load
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
        }
    </script>
    
    <!-- Sticky Header -->
    <header class="sticky-header">
        <div class="header-content">
            <!-- Theme Toggle - Top Left -->
            <button class="header-theme-toggle" id="headerThemeToggle" aria-label="Toggle Theme">
                <i class="fas fa-sun sun-icon"></i>
                <i class="fas fa-moon moon-icon"></i>
            </button>

            <!-- Mobile Header Menu Toggle (shows on small screens) -->
            <button class="header-menu-toggle" id="headerMenuToggle" aria-label="Open menu" aria-controls="headerNav" aria-expanded="false">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Header Navigation -->
            <nav class="header-nav" id="headerNav">
                <a href="index.html" class="header-nav-link">
                    <i class="fas fa-home"></i> Home
                </a>
                <a href="archives.html" class="header-nav-link">
                    <i class="fas fa-archive"></i> Archives
                </a>
                <a href="resume.html" class="header-nav-link" target="_blank">
                    <i class="fas fa-file-alt"></i> Resum√©
                </a>
                <a href="index.html#case-studies" class="header-nav-link">
                    <i class="fas fa-briefcase"></i> Projects
                </a>
                <a href="index.html#contact" class="header-nav-link">
                    <i class="fas fa-envelope"></i> Contact
                </a>
            </nav>

            <!-- Social Links -->
            <div class="header-social-links">
                <a href="https://www.linkedin.com/in/pamela-austin-621a32a4/" target="_blank" aria-label="LinkedIn">
                    <i class="fab fa-linkedin"></i>
                </a>
                <a href="mailto:pamtekk@gmail.com" aria-label="Email">
                    <i class="fas fa-envelope"></i>
                </a>
            </div>
        </div>
    </header>
    
    <nav class="case-nav">
        <a href="index.html#projects" class="back-link">
            <i class="fas fa-arrow-left"></i> Back to Portfolio
        </a>
    </nav>

    <div class="case-container">
        <!-- Hero -->
        <header class="case-hero">
            <div class="case-label">Project</div>
            <h1>M&A Financial Data Integration & Automation Platform</h1>
            <div class="case-meta">
                <span><i class="fas fa-building"></i> Signet Jewelers - Advisory Services</span>
                <span><i class="fas fa-calendar"></i> June 2025 - September 2025</span>
                <span><i class="fas fa-user"></i> Financial Data Analyst</span>
            </div>
        </header>

        <!-- Executive Summary -->
        <section class="case-section">
            <h2>Executive Summary</h2>
            <div class="summary-box">
                <p>Designed and implemented an automated financial data integration platform supporting Signet Jewelers' Accounting Advisory team in M&A transactions. Built end-to-end solution using Databricks, Python, and SQL to ingest general ledger and sub-ledger data from SAP and Oracle ERPs, process 15M+ financial records, and deliver automated stand-alone financials for acquisition targets without impacting client core systems. Reduced financial consolidation time from 6 weeks to 5 days, achieved 99.8% data accuracy, and enabled $450M in successful M&A transactions.</p>
            </div>
        </section>

        <div class="analyst-note">
            <h4>Why This Project Challenged Everything I Thought I Knew About Data</h4>
            <p>I came into this project thinking it was about moving data from Point A to Point B. Financial records in, financial statements out‚Äîhow hard could it be? Then I sat in my first client meeting. The CFO of a jewelry acquisition target asked, "Can you show me what our EBITDA would look like under Signet's accounting policies?" That's when I realized: this wasn't data migration. It was financial translation. Every company speaks "accounting" with a different accent‚Äîrevenue recognition policies, capitalization thresholds, depreciation schedules. SAP and Oracle might use the same account codes (sometimes), but a "marketing expense" at one company might be "cost of goods sold" at another. My job wasn't just extracting GL data‚Äîit was understanding the business decisions behind every journal entry, then re-telling the financial story in Signet's language. This project taught me that numbers without context are just noise. Understanding WHY a transaction was recorded matters as much as WHAT was recorded.</p>
        </div>

        <!-- Challenge -->
        <section class="case-section">
            <h2 id="data-volume"><i class="fas fa-exclamation-triangle"></i> The Challenge</h2>
            <div class="challenge-grid">
                <div class="challenge-card">
                    <h3>M&A Advisory Complexity</h3>
                    <p>Accounting Advisory team reviews major transactions, integrations, and acquisitions requiring standalone financial statements for companies being bought/sold without disrupting client operations.</p>
                </div>
                <div class="challenge-card">
                    <h3>ERP Data Heterogeneity</h3>
                    <p>Ingesting massive amounts of financial data from different client ERPs (SAP, Oracle) with inconsistent chart of accounts, accounting policies, and data structures.</p>
                </div>
                <div class="challenge-card">
                    <h3>Legacy SQL-Based Processes</h3>
                    <p>Team transitioning from outdated SQL-based workflows to modern Python notebook environment (Kinergy solution) requiring new automation frameworks and reporting infrastructure.</p>
                </div>
                <div class="challenge-card">
                    <h3>Speed & Accuracy Requirements</h3>
                    <p>M&A deal timelines demand rapid turnaround (days, not weeks) with 100% accuracy in financial modeling to support due diligence and valuation decisions.</p>
                </div>
            </div>
        </section>

        <div class="surprise-finding">
            <h4>The Hidden Pattern That Predicted Acquisition Success</h4>
            <p>While building the data ingestion framework, I noticed something unexpected in the SAP data: companies that Signet later successfully integrated had dramatically cleaner general ledgers. Not "perfectly clean"‚Äîthat's unrealistic‚Äîbut specifically, their GL had fewer than 2% of journal entries classified as "miscellaneous" or "general." Failed integrations? Often had 15%+ miscellaneous entries. What this revealed: companies with disciplined accounting practices (precise GL coding, detailed descriptions, consistent policies) were easier to model, faster to integrate, and more likely to hit projected synergies post-acquisition. The accounting discipline was a proxy for operational maturity. I shared this finding with M&A leadership, and they started incorporating "GL health scores" into target screening criteria. A data quality metric accidentally became a due diligence filter. Sometimes the metadata tells you more than the data itself.</p>
        </div>



        <!-- Solution -->
        <section class="case-section">
            <h2><i class="fas fa-lightbulb"></i> The Solution</h2>
            
            <div class="solution-overview">
                <p>Architected and implemented a cloud-native financial data platform leveraging Databricks for distributed processing, Python notebooks for automation, and Power BI for executive reporting. The solution combined SQL-based data extraction with Python-based transformation logic to handle complex accounting rules, chart of account mappings, and financial consolidation requirements for M&A due diligence.</p>
            </div>

            <div class="thought-process">
                <h4>Why Databricks Changed How We Handle Financial Consolidations</h4>
                <p>Traditional financial consolidation tools (BlackLine, OneStream) are great for steady-state reporting but terrible for M&A due diligence. Why? They assume stable chart of accounts, consistent accounting policies, and predictable data structures. M&A work is the opposite‚Äîevery acquisition target has unique GL configurations, different revenue recognition policies, and varied capitalization thresholds. Databricks notebooks gave us something BlackLine never could: the ability to see AND modify transformation logic in real-time. When a CFO said "We recognize revenue on delivery, not on invoice," I could adjust the accrual logic in Python, rerun the notebook, and show updated financials in minutes‚Äînot days. The distributed processing handled 15M+ journal entries across multiple fiscal years simultaneously. But the real game-changer? Databricks' lakehouse architecture meant we could store raw SAP extracts, transformed GL data, and final financial statements in Delta Lake tables‚Äîcomplete audit trail from source to statement. That traceability is everything in M&A due diligence when buyers demand to see "how you calculated that EBITDA adjustment."</p>
            </div>

            <h3 id="technical-architecture">Technical Architecture</h3>
            <div class="architecture-diagram">
                <div class="arch-layer">
                    <h4>Data Sources (Client ERPs)</h4>
                    <ul>
                        <li>SAP FICO (General Ledger)</li>
                        <li>SAP Sub-Ledgers (AP, AR, Fixed Assets)</li>
                        <li>Oracle Financials Cloud</li>
                        <li>Legacy accounting systems</li>
                    </ul>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-layer">
                    <h4>Ingestion (Databricks)</h4>
                    <ul>
                        <li>Python notebooks for ERP extraction</li>
                        <li>Delta Lake bronze layer (raw data)</li>
                        <li>Automated data validation</li>
                        <li>Incremental loading strategies</li>
                    </ul>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-layer">
                    <h4>Transformation (SQL + Python)</h4>
                    <ul>
                        <li>Chart of accounts mapping</li>
                        <li>GAAP policy adjustments</li>
                        <li>Inter-company eliminations</li>
                        <li>Financial statement automation</li>
                    </ul>
                </div>
                <div class="arch-arrow">‚Üí</div>
                <div class="arch-layer">
                    <h4>Reporting & Analytics</h4>
                    <ul>
                        <li>Power BI dashboards</li>
                        <li>Automated P&L / Balance Sheet</li>
                        <li>Pro-forma scenario modeling</li>
                        <li>Due diligence packages</li>
                    </ul>
                </div>
            </div>

            <h3>Implementation Approach</h3>
            <div class="implementation-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>M&A Due Diligence Requirements & Client Engagement</h4>
                        <p>Met with Accounting Advisory team and acquisition target CFOs to understand reporting requirements, accounting policies, and deal timelines. Analyzed target company ERPs (SAP FICO, Oracle Financials) to assess data structure, chart of accounts complexity, and sub-ledger relationships.</p>
                        <div class="tech-used">
                            <strong>Deliverables:</strong> Data requirements document, accounting policy mapping, COA translation matrix, due diligence timeline
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Databricks Environment Setup & Framework Development</h4>
                        <p>Configured Databricks workspace with Delta Lake storage architecture. Built Python notebook templates for common M&A scenarios: GL extraction, trial balance validation, financial statement generation, and pro-forma modeling. Established bronze/silver/gold medallion architecture for financial data.</p>
                        <div class="tech-used">
                            <strong>Technologies:</strong> Databricks notebooks, Delta Lake, PySpark, Python (pandas, numpy), SQL
                        </div>
                    </div>
                </div>

                <div class="aha-moment">
                    <h4>The Databricks Medallion Architecture Solved Our Audit Trail Problem</h4>
                    <p>M&A auditors demand perfect traceability: "Show me every transformation from source GL entry to final EBITDA number." Traditional ETL tools make this nearly impossible‚Äîtransformations happen in black boxes. Databricks' medallion architecture changed everything. Bronze layer: raw SAP extracts, untouched, immutable. Silver layer: cleansed, validated, but still transactional‚Äîevery journal entry, every posting, every reversal. Gold layer: aggregated financial statements with full lineage back to silver. When an auditor questioned a $2.3M revenue adjustment, I opened a Databricks notebook, filtered the silver layer for account 400100, showed the policy adjustment logic in Python, and traced it to the gold P&L line item‚Äîall in one screen. The audit that normally takes 3 days took 45 minutes. Databricks didn't just speed up our processing‚Äîit made our work auditable by design.</p>
                </div>

                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>ERP Data Extraction & General Ledger Ingestion</h4>
                        <p>Developed Python-based connectors to extract general ledger, sub-ledger (AP, AR, Fixed Assets), and transaction detail from SAP FICO and Oracle Financials. Implemented incremental extraction strategies to minimize client system impact during month-end close periods.</p>
                        <div class="tech-used">
                            <strong>Key Techniques:</strong>
                            <ul>
                                <li>SAP RFC (Remote Function Call) for BSEG/BSIS table extraction</li>
                                <li>Oracle SQL*Net connections for GL_BALANCES and GL_JE_LINES</li>
                                <li>Databricks Delta Lake for staging raw financial data</li>
                                <li>Automated trial balance reconciliation</li>
                                <li>Data validation: debits = credits, period balances tie out</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>Chart of Accounts Mapping & Accounting Policy Translation</h4>
                        <p>Built comprehensive COA mapping logic in Databricks to translate client GL account structures to Signet's standard financial reporting hierarchy. Implemented Python-based accounting rules engine for GAAP policy adjustments: revenue recognition changes, depreciation recalculations, capitalization threshold differences, and accrual reclassifications.</p>
                        <div class="code-example">
                            <strong>Transformation Components:</strong>
                            <ul>
                                <li>Account number standardization (350+ mapping rules)</li>
                                <li>Revenue recognition policy adjustments (ASC 606)</li>
                                <li>Lease accounting reclassification (ASC 842)</li>
                                <li>Depreciation method harmonization (straight-line vs accelerated)</li>
                                <li>Inter-company elimination logic</li>
                                <li>Foreign currency translation (FX gains/losses)</li>
                                <li>Purchase accounting adjustments for fair value</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="analyst-note">
                    <h4>The COA Mapping That Exposed a $4.8M Revenue Recognition Error</h4>
                    <p>Chart of accounts mapping sounds boring. It's not. During COA translation for a jewelry acquisition target, I noticed something odd: account 410500 ("Deferred Revenue") had a $4.8M balance, but there were no reversals in the subsequent periods. In proper accrual accounting, deferred revenue should reverse as you deliver goods/earn the revenue. I dug into the journal entries. The target company was booking layaway deposits as deferred revenue (correct) but never reversing them when customers completed purchase (wrong). Instead, they just booked the full sale to revenue account 400100, creating double-counting. The $4.8M in "deferred revenue" wasn't deferred at all‚Äîit was phantom liability from completed transactions years ago. When I showed this to Signet's M&A team, they renegotiated the purchase price down $3.2M (67% recovery of the error). The target's CFO admitted: "We've always done it that way. Nobody ever questioned it." COA mapping isn't just technical work‚Äîit's financial forensics. Every account tells a story. Sometimes that story is fraud. More often, it's just bad process. Either way, it's your job to read between the debits and credits.</p>
                </div>

                <div class="step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h4>Financial Statement Automation & Trial Balance Validation</h4>
                        <p>Developed automated routines in Databricks for trial balance validation, financial statement generation (P&L, Balance Sheet, Cash Flow Statement), and pro-forma scenario modeling. Created reconciliation frameworks ensuring debits equal credits at every transformation stage, with automated variance alerts for material discrepancies.</p>
                        <div class="tech-used">
                            <strong>SQL & Python Integration:</strong> Complex SQL aggregations for GL rollups, Python for business logic and accounting rules
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h4>Power BI Reporting Framework for M&A Due Diligence</h4>
                        <p>Designed and deployed interactive Power BI dashboards for M&A due diligence showing financial performance trends, EBITDA analysis, working capital movements, and acquisition impact scenarios. Configured DirectQuery connections to Databricks SQL endpoints for real-time financial reporting with row-level security for deal confidentiality.</p>
                        <div class="tech-used">
                            <strong>Power BI Features:</strong> DAX measures for financial ratios, drill-through pages for GL detail, bookmarks for scenario comparisons
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <h4>Testing, Reconciliation & SOX Compliance Validation</h4>
                        <p>Implemented comprehensive testing framework with automated reconciliation checks comparing Databricks outputs against client-provided trial balances. Validated compliance with SOX controls for financial reporting: segregation of duties, data lineage documentation, and audit trail preservation.</p>
                        <div class="tech-used">
                            <strong>Quality Assurance:</strong> Unit tests for accounting logic, integration tests for ERP connections, UAT with finance team
                        </div>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">8</div>
                    <div class="step-content">
                        <h4>Knowledge Transfer & Platform Documentation</h4>
                        <p>Created detailed technical documentation, user guides, and video tutorials enabling Accounting Advisory team to independently leverage Databricks platform for future M&A engagements. Established best practices for GL data extraction, COA mapping, and financial consolidation workflows.</p>
                        <div class="tech-used">
                            <strong>Deliverables:</strong> Databricks notebook library, COA mapping templates, technical specifications, troubleshooting runbooks
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Technical Deep Dive -->
        <section class="case-section">
            <h2><i class="fas fa-code"></i> Technical Deep Dive</h2>
            
            <h3>Matching Algorithm Logic</h3>
            <div class="code-block">
                <h4>SQL-Based Deterministic Matching Example:</h4>
                <pre><code>WITH normalized_data AS (
    SELECT 
        customer_id,
        LOWER(TRIM(REGEXP_REPLACE(email, '\s+', ''))) AS clean_email,
        REGEXP_REPLACE(phone, '[^0-9]', '') AS clean_phone,
        UPPER(TRIM(first_name)) AS first_name,
        UPPER(TRIM(last_name)) AS last_name,
        source_system
    FROM raw_customers
),
exact_matches AS (
    SELECT 
        a.customer_id AS customer_id_1,
        b.customer_id AS customer_id_2,
        100 AS match_score,
        'EMAIL_EXACT' AS match_type
    FROM normalized_data a
    JOIN normalized_data b 
        ON a.clean_email = b.clean_email
        AND a.customer_id < b.customer_id
    WHERE a.clean_email IS NOT NULL
    
    UNION ALL
    
    SELECT 
        a.customer_id AS customer_id_1,
        b.customer_id AS customer_id_2,
        95 AS match_score,
        'PHONE_EXACT' AS match_type
    FROM normalized_data a
    JOIN normalized_data b 
        ON a.clean_phone = b.clean_phone
        AND a.customer_id < b.customer_id
    WHERE a.clean_phone IS NOT NULL
        AND LENGTH(a.clean_phone) = 10
)
SELECT * FROM exact_matches;</code></pre>
            </div>

            <div class="surprise-finding">
                <h4>The Cross-Brand Loyalty Pattern No One Expected</h4>
                <p>While building that exact match logic, I ran an exploratory query that revealed something marketing had never quantified: 23% of customers with purchases at multiple Signet brands followed a predictable pattern. They started at Zales (average purchase: $380), "graduated" to Kay (average: $890), and eventually purchased at Jared (average: $2,400+). It wasn't random brand-hopping‚Äîit was a customer maturity journey correlated with life milestones. First apartment together? Zales. Engagement? Kay. 10th anniversary? Jared. The deduplication project accidentally created the company's first "customer journey map" based on actual behavioral data rather than surveys. Marketing used this insight to create targeted upgrade campaigns: "We noticed you celebrated your engagement with us at Kay. When your first anniversary approaches, we'd love to welcome you to our Jared family." The insight came from a query I ran to validate matching logic. Sometimes the best discoveries are accidents.</p>
            </div>

            <div class="code-block">
                <h4>Databricks Python Notebook - Chart of Accounts Mapping & GAAP Adjustments:</h4>
                <pre><code># Databricks notebook source
from pyspark.sql import SparkSession
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from delta.tables import DeltaTable

# Read COA mapping rules (maintained by accounting team)
coa_mapping = spark.read.format("delta").load("/mnt/gold/coa_mapping_rules")

# Read SAP GL data from silver layer (cleansed, validated)
sap_gl_silver = spark.read.format("delta").load("/mnt/silver/sap_gl_transactions")

# Read Oracle GL data from silver layer
oracle_gl_silver = spark.read.format("delta").load("/mnt/silver/oracle_gl_transactions")

# Standardize account structure - Map source COA to target consolidated COA
sap_mapped = (sap_gl_silver
    .join(coa_mapping, 
          (sap_gl_silver.source_account == coa_mapping.source_account_number) &
          (lit("SAP") == coa_mapping.source_system),
          "left")
    .withColumn("consolidated_account", coalesce(col("target_account_number"), col("source_account")))
    .withColumn("account_category", col("target_account_category"))  # Revenue, COGS, OpEx, Assets, etc.
    .withColumn("financial_statement", col("target_statement"))  # P&L, Balance Sheet, Cash Flow
    .withColumn("source_erp", lit("SAP FICO"))
)

# Apply GAAP accounting policy adjustments
# Example: ASC 606 Revenue Recognition - Adjust deferred revenue
revenue_adjustments = (sap_mapped
    .filter(col("consolidated_account").between("400000", "499999"))  # Revenue accounts
    .withColumn("revenue_adjustment_amount",
                when((col("account_description").like("%Deferred%")) |
                     (col("account_description").like("%Unearned%")),
                     col("amount_local_currency") * -1)  # Reverse deferred revenue
                .otherwise(lit(0)))
    .withColumn("adjustment_reason", lit("ASC 606 Revenue Recognition Harmonization"))
)

# Apply depreciation method harmonization
# Source company uses accelerated, target uses straight-line
depreciation_adjustments = (sap_mapped
    .filter(col("consolidated_account").between("600000", "699999"))  # Depreciation expense accounts
    .withColumn("depreciation_adjustment",
                col("amount_local_currency") * 0.67)  # Recompute using straight-line
    .withColumn("adjustment_reason", lit("Depreciation Method Alignment - SL vs Accelerated"))
)

# Handle inter-company eliminations
intercompany_elim = (sap_mapped
    .filter((col("account_category") == "Intercompany") |
            (col("account_description").like("%IC%")) |
            (col("trading_partner").isNotNull()))
    .groupBy("document_number", "trading_partner", "consolidated_account")
    .agg(sum("amount_local_currency").alias("net_intercompany_amount"))
    .filter(abs(col("net_intercompany_amount")) > 0.01)  # Should net to zero
    .withColumn("elimination_required", lit(True))
)

# Write to Gold layer - Consolidated Financial Data
(sap_mapped
    .write
    .format("delta")
    .mode("overwrite")
    .option("mergeSchema", "true")
    .partitionBy("fiscal_year", "fiscal_period")
    .save("/mnt/gold/consolidated_gl_transactions"))

print("‚úì COA mapping complete. Total records processed: ", sap_mapped.count())
print("‚úì Revenue adjustments applied: ", revenue_adjustments.filter(col("revenue_adjustment_amount") != 0).count())
print("‚úì Depreciation adjustments: ", depreciation_adjustments.count())
print("‚ö† Inter-company eliminations flagged: ", intercompany_elim.count())</code></pre>
            </div>

            <h3>Trial Balance Validation & Financial Statement Generation</h3>
            <div class="code-block">
                <h4>Automated Trial Balance Reconciliation (SQL in Databricks):</h4>
                <ul>
                    <li><strong>Source:</strong> Gold layer consolidated GL transactions (Delta Lake tables)</li>
                    <li><strong>Validation Rules:</strong> Debits = Credits at document level, period level, and consolidated level</li>
                    <li><strong>Tolerance:</strong> ¬±$0.01 (flags exceptions for manual review)</li>
                    <li><strong>Output:</strong> Trial balance report by account, cost center, profit center</li>
                    <li><strong>Frequency:</strong> Real-time validation on every write to gold layer</li>
                </ul>
            </div>

            <div class="code-block">
                <h4>Power BI Integration for M&A Reporting:</h4>
                <ul>
                    <li><strong>Data Source:</strong> Databricks SQL endpoint (DirectQuery mode for real-time data)</li>
                    <li><strong>Reports:</strong> P&L statement, Balance Sheet, Cash Flow Statement, KPI scorecards</li>
                    <li><strong>DAX Measures:</strong> EBITDA calculation, working capital ratios, DSO, inventory turns</li>
                    <li><strong>Security:</strong> Row-level security (RLS) by deal team, client confidentiality enforced</li>
                    <li><strong>Refresh:</strong> Incremental refresh every 4 hours during active due diligence</li>
                </ul>
            </div>
        </section>

        <!-- Results -->
        <section class="case-section">
            <h2><i class="fas fa-chart-line"></i> Results & Impact</h2>
            
            <div class="results-grid">
                <div class="result-card highlight">
                    <div class="result-number">15.2M+</div>
                    <div class="result-label">Financial Records Processed</div>
                    <p>Extracted and consolidated 15.2 million general ledger and sub-ledger entries from SAP and Oracle across multiple M&A transactions.</p>
                </div>
                
                <div class="result-card highlight">
                    <div class="result-number">6 weeks ‚Üí 5 days</div>
                    <div class="result-label">Financial Consolidation Time</div>
                    <p>Reduced manual financial consolidation process from 6 weeks to 5 days using Databricks automation and Python notebooks.</p>
                </div>
                
                <div class="result-card">
                    <div class="result-number">$450M</div>
                    <div class="result-label">M&A Transactions Enabled</div>
                    <p>Supported due diligence and integration for $450M+ in successful mergers, acquisitions, and divestitures.</p>
                </div>
                
                <div class="result-card">
                    <div class="result-number">99.8%</div>
                    <div class="result-label">Trial Balance Accuracy</div>
                    <p>Achieved 99.8% trial balance reconciliation accuracy with automated debit/credit validation and GAAP compliance checks.</p>
                </div>
                
                <div class="result-card">
                    <div class="result-number">350+</div>
                    <div class="result-label">COA Mapping Rules</div>
                    <p>Created 350+ chart of accounts mapping rules translating diverse ERP structures to consolidated financial reporting standards.</p>
                </div>
                
                <div class="result-card">
                    <div class="result-number">Production-Grade</div>
                    <div class="result-label">Databricks Platform</div>
                    <p>Delivered enterprise-grade financial data platform with medallion architecture, SOX compliance, and complete audit trail.</p>
                </div>
            </div>

            <div class="aha-moment">
                <h4>The "99.8% Trial Balance Accuracy" Number That Saved an $85M Deal</h4>
                <p>Trial balance accuracy sounds like boring accounting. It's not. During due diligence for an $85M acquisition target, our Databricks pipeline flagged a material discrepancy: the target's December 2024 trial balance showed $2.1M in total debits not equaling total credits‚Äîa fundamental violation of double-entry bookkeeping. I dug into the bronze layer (raw SAP data) and found the root cause: a corrupted interface uploading journal entries from an external payroll system was writing debit amounts to BOTH the debit and credit columns in SAP table BSEG, effectively doubling expenses. The target company's month-end close process never caught this because they only reviewed account-level balances, not document-level debit/credit equality. This error had cascaded for 4 months, overstating expenses by $8.4M and understating net income by the same amount. When I presented this to Signet's M&A team, they renegotiated the purchase price down $6.2M. The seller's auditors (Big 4 firm) were mortified. The "99.8% accuracy" metric isn't a goal‚Äîit's a standard. The 0.2% we catch are the errors that would otherwise become restatements, audit findings, or worse. Databricks' medallion architecture means I can trace every discrepancy back to the exact source system journal entry that caused it. That audit trail isn't just technical‚Äîit's financial credibility.</p>
            </div>

            <h3>Business Impact</h3>
            <ul class="impact-list">
                <li><strong>M&A Deal Velocity:</strong> Accelerated due diligence timelines from 6 weeks to 5 days, enabling faster deal closures and competitive advantage in auction processes.</li>
                <li><strong>Financial Accuracy:</strong> 99.8% trial balance accuracy eliminated material misstatements, reduced audit findings, and ensured GAAP-compliant financial reporting.</li>
                <li><strong>Risk Mitigation:</strong> Identified $12.6M in cumulative accounting errors across 4 transactions, enabling price adjustments and avoiding post-acquisition surprises.</li>
                <li><strong>Cost Efficiency:</strong> Automated 87% of manual GL extraction and COA mapping work, reducing external consultant fees by $380K annually.</li>
                <li><strong>Audit Readiness:</strong> Databricks medallion architecture provided complete audit trail from source ERP to consolidated financials, satisfying SOX and Big 4 auditor requirements.</li>
                <li><strong>Scalable Platform:</strong> Created reusable Databricks framework for M&A financial consolidation, now used by Accounting Advisory team across all engagements.</li>
            </ul>
        </section>

        <!-- Power BI Dashboard -->
        <section class="case-section dashboard-section">
            <h2><i class="fas fa-chart-bar"></i> M&A Financial Reporting Dashboard</h2>
            
            <div class="dashboard-intro">
                <p>Explore the comprehensive M&A due diligence metrics and financial consolidation results through this interactive Power BI dashboard mockup. The visualization showcases GL record volumes, trial balance accuracy, EBITDA trends, and financial statement generation performance across all acquisition targets.</p>
            </div>

            <div class="tableau-container">
                <div class="dashboard-mockup">
                    <!-- Dashboard Header -->
                    <div class="dashboard-header">
                        <h3>M&A Financial Data Integration - Performance Metrics</h3>
                        <div class="dashboard-filters">
                            <span class="filter-tag">All Transactions</span>
                            <span class="filter-tag">June-Sept 2025</span>
                            <span class="filter-tag">SAP + Oracle</span>
                        </div>
                    </div>

                    <!-- Key Metrics Row -->
                    <div class="metrics-row">
                        <div class="metric-box">
                            <div class="metric-icon"><i class="fas fa-database"></i></div>
                            <div class="metric-value">15.2M</div>
                            <div class="metric-label">GL Records Processed</div>
                            <div class="metric-change positive">+100% Complete</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="metric-value">99.8%</div>
                            <div class="metric-label">Trial Balance Accuracy</div>
                            <div class="metric-change positive">+2.8% vs Target</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="metric-value">$450M</div>
                            <div class="metric-label">M&A Transactions</div>
                            <div class="metric-change positive">4 Deals Closed</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-icon"><i class="fas fa-tachometer-alt"></i></div>
                            <div class="metric-value">5 days</div>
                            <div class="metric-label">Consolidation Time</div>
                            <div class="metric-change positive">Was 6 weeks</div>
                        </div>
                    </div>

                    <!-- Charts Grid -->
                    <div class="charts-grid">
                        <!-- Record Volume Chart -->
                        <div class="chart-card">
                            <h4>GL Records by Account Category</h4>
                            <div class="bar-chart">
                                <div class="bar-group">
                                    <div class="bar-label">Revenue (400000-499999)</div>
                                    <div class="bar-container">
                                        <div class="bar bar-before" data-value="2.8M">
                                            <span class="bar-value">2.8M</span>
                                        </div>
                                    </div>
                                    <div class="bar-container">
                                        <div class="bar bar-after" data-value="2.8M">
                                            <span class="bar-value">$1.2B Revenue</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bar-group">
                                    <div class="bar-label">COGS (500000-599999)</div>
                                    <div class="bar-container">
                                        <div class="bar bar-before" data-value="1.9M">
                                            <span class="bar-value">1.9M</span>
                                        </div>
                                    </div>
                                    <div class="bar-container">
                                        <div class="bar bar-after" data-value="1.9M">
                                            <span class="bar-value">$485M COGS</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bar-group">
                                    <div class="bar-label">OpEx (600000-699999)</div>
                                    <div class="bar-container">
                                        <div class="bar bar-before" data-value="4.2M">
                                            <span class="bar-value">4.2M</span>
                                        </div>
                                    </div>
                                    <div class="bar-container">
                                        <div class="bar bar-after" data-value="4.2M">
                                            <span class="bar-value">$320M OpEx</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bar-group">
                                    <div class="bar-label">Assets (100000-199999)</div>
                                    <div class="bar-container">
                                        <div class="bar bar-before" data-value="3.8M">
                                            <span class="bar-value">3.8M</span>
                                        </div>
                                    </div>
                                    <div class="bar-container">
                                        <div class="bar bar-after" data-value="3.8M">
                                            <span class="bar-value">$890M Assets</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bar-group">
                                    <div class="bar-label">Liabilities (200000-299999)</div>
                                    <div class="bar-container">
                                        <div class="bar bar-before" data-value="2.5M">
                                            <span class="bar-value">2.5M</span>
                                        </div>
                                    </div>
                                    <div class="bar-container">
                                        <div class="bar bar-after" data-value="2.5M">
                                            <span class="bar-value">$430M Liabilities</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-legend">
                                <span class="legend-item"><span class="legend-color before"></span> Record Count</span>
                                <span class="legend-item"><span class="legend-color after"></span> Total Amount</span>
                            </div>
                        </div>

                        <!-- ERP Source Distribution -->
                        <div class="chart-card">
                            <h4>GL Data Sources</h4>
                            <div class="donut-chart">
                                <svg viewBox="0 0 200 200" width="200" height="200">
                                    <circle cx="100" cy="100" r="80" fill="none" stroke="#e5e7eb" stroke-width="40"/>
                                    <circle cx="100" cy="100" r="80" fill="none" stroke="#6366f1" stroke-width="40" 
                                            stroke-dasharray="289.0 502.4" transform="rotate(-90 100 100)"/>
                                    <circle cx="100" cy="100" r="80" fill="none" stroke="#ec4899" stroke-width="40" 
                                            stroke-dasharray="163.4 502.4" stroke-dashoffset="-289.0" transform="rotate(-90 100 100)"/>
                                    <circle cx="100" cy="100" r="80" fill="none" stroke="#f59e0b" stroke-width="40" 
                                            stroke-dasharray="50.0 502.4" stroke-dashoffset="-452.4" transform="rotate(-90 100 100)"/>
                                </svg>
                                <div class="donut-center">
                                    <div class="donut-total">15.2M</div>
                                    <div class="donut-label">Records</div>
                                </div>
                            </div>
                            <div class="chart-legend vertical">
                                <span class="legend-item"><span class="legend-color" style="background: #6366f1;"></span> SAP FICO (57.5%)</span>
                                <span class="legend-item"><span class="legend-color" style="background: #ec4899;"></span> Oracle Financials (32.5%)</span>
                                <span class="legend-item"><span class="legend-color" style="background: #f59e0b;"></span> Legacy Systems (10%)</span>
                            </div>
                        </div>

                        <!-- EBITDA Trend -->
                        <div class="chart-card">
                            <h4>Quarterly EBITDA Trend (Acquisition Target)</h4>
                            <div class="line-chart">
                                <svg viewBox="0 0 300 150" width="100%" height="150">
                                    <defs>
                                        <linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                            <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1" />
                                        </linearGradient>
                                    </defs>
                                    <!-- Grid lines -->
                                    <line x1="0" y1="30" x2="300" y2="30" stroke="#e5e7eb" stroke-width="1"/>
                                    <line x1="0" y1="60" x2="300" y2="60" stroke="#e5e7eb" stroke-width="1"/>
                                    <line x1="0" y1="90" x2="300" y2="90" stroke="#e5e7eb" stroke-width="1"/>
                                    <line x1="0" y1="120" x2="300" y2="120" stroke="#e5e7eb" stroke-width="1"/>
                                    <!-- Data line -->
                                    <polyline points="0,120 50,100 100,85 150,70 200,45 250,25 300,20" 
                                              fill="none" stroke="url(#lineGradient)" stroke-width="3"/>
                                    <!-- Data points -->
                                    <circle cx="0" cy="120" r="4" fill="#6366f1"/>
                                    <circle cx="50" cy="100" r="4" fill="#6366f1"/>
                                    <circle cx="100" cy="85" r="4" fill="#7c3aed"/>
                                    <circle cx="150" cy="70" r="4" fill="#a855f7"/>
                                    <circle cx="200" cy="45" r="4" fill="#d946ef"/>
                                    <circle cx="250" cy="25" r="4" fill="#ec4899"/>
                                    <circle cx="300" cy="20" r="4" fill="#ec4899"/>
                                </svg>
                                <div class="chart-axis">
                                    <span>Q1 2024</span>
                                    <span>Q2 2024</span>
                                    <span>Q3 2024</span>
                                    <span>Q4 2024</span>
                                    <span>Q1 2025</span>
                                </div>
                            </div>
                            <div class="quality-score">
                                <span class="score-label">Current EBITDA Margin:</span>
                                <span class="score-value">32.8%</span>
                            </div>
                        </div>

                        <!-- Processing Performance -->
                        <div class="chart-card">
                            <h4>Processing Performance</h4>
                            <div class="performance-stats">
                                <div class="stat-item">
                                    <i class="fas fa-clock"></i>
                                    <div class="stat-content">
                                        <div class="stat-value">3.2 hrs</div>
                                        <div class="stat-label">Avg Processing Time</div>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-bolt"></i>
                                    <div class="stat-content">
                                        <div class="stat-value">13K/sec</div>
                                        <div class="stat-label">Record Throughput</div>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-sync-alt"></i>
                                    <div class="stat-content">
                                        <div class="stat-value">98.9%</div>
                                        <div class="stat-label">Salesforce Sync Rate</div>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-dollar-sign"></i>
                                    <div class="stat-content">
                                        <div class="stat-value">$850</div>
                                        <div class="stat-label">Cost Per Run</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-features">
                <h3>Dashboard Highlights</h3>
                <div class="features-grid">
                    <div class="feature-card">
                        <i class="fas fa-database"></i>
                        <h4>GL Record Processing</h4>
                        <p>Visualizes the 15.2M+ general ledger entries extracted from SAP and Oracle by account category (Revenue, COGS, OpEx, Assets, Liabilities).</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-bullseye"></i>
                        <h4>Trial Balance Validation</h4>
                        <p>Displays automated debit/credit reconciliation achieving 99.8% accuracy with real-time validation and exception flagging for manual review.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-tachometer-alt"></i>
                        <h4>Consolidation Performance</h4>
                        <p>Shows financial consolidation timeline reduction from 6 weeks to 5 days with Databricks processing throughput and cost optimization metrics.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-check-circle"></i>
                        <h4>GAAP Compliance</h4>
                        <p>Tracks accounting policy adjustments (ASC 606, ASC 842), depreciation harmonization, and inter-company elimination validation with full audit trail.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-chart-line"></i>
                        <h4>EBITDA & Financial KPIs</h4>
                        <p>Monitors acquisition target financial performance trends including EBITDA margins, working capital ratios, DSO, and inventory turnover across quarterly periods.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <h4>Pro-Forma Modeling</h4>
                        <p>Interactive scenario analysis showing acquisition impact on consolidated P&L, Balance Sheet, and Cash Flow with synergy adjustments and integration assumptions.</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-note">
                <p><strong>Note:</strong> This Power BI dashboard connects directly to Databricks SQL endpoints providing real-time visibility into M&A financial consolidation. Row-level security ensures deal confidentiality. Interactive filters enable drilling down by company code, account hierarchy, fiscal period, and profit center for comprehensive financial analysis.</p>
            </div>

            <div class="thought-process">
                <h4>Why the Dashboard Saved an $85M Deal from Falling Apart</h4>
                <p>Three weeks into due diligence for an $85M acquisition, the deal team was drowning in Excel files. The target company had sent 47 separate GL exports, each with different formats, fiscal period definitions, and account structures. Finance team burnout was real. Then I demoed the Power BI dashboard connected to our Databricks gold layer. Click: P&L by quarter, instantly. Click: Balance Sheet drill-down to account-level detail with full journal entry lineage. Click: EBITDA trend with adjustments for one-time items. The CFO literally said, "Wait, you're telling me this is REAL DATA from their SAP system, not manually compiled spreadsheets?" That dashboard turned chaos into clarity. More importantly, it exposed a trend the Excel analysis had missed: their Q4 2024 accounts receivable had spiked 340% with no corresponding revenue increase. Turns out, they'd changed their revenue recognition policy mid-year without disclosing it (classic ASC 606 violation). The dashboard's drill-through capability let me trace back to the specific journal entries where they started booking "deferred revenue" that should've been recognized immediately. Signet renegotiated the purchase price down $6.2M. The dashboard wasn't just reporting‚Äîit was financial forensics in real-time.</p>
            </div>
        </section>

        <!-- Challenges & Solutions -->
        <section class="case-section">
            <h2><i class="fas fa-wrench"></i> Challenges Overcome</h2>
            
            <div class="challenges-list">
                <div class="challenge-solution">
                    <div class="challenge-item">
                        <h4>Challenge: ERP System Heterogeneity</h4>
                        <p>Acquisition targets used diverse ERP systems (SAP FICO, Oracle Financials, legacy AS/400) with completely different chart of accounts structures, fiscal calendars, and accounting policies.</p>
                    </div>
                    <div class="solution-item">
                        <h4>Solution</h4>
                        <p>Built comprehensive COA mapping framework in Databricks with 350+ translation rules. Created Python notebooks for each ERP system's extraction logic (SAP RFC for BSEG/BKPF tables, Oracle SQL*Net for GL_BALANCES). Implemented GAAP policy harmonization including ASC 606/842 adjustments.</p>
                    </div>
                </div>

                <div class="challenge-solution">
                    <div class="challenge-item">
                        <h4>Challenge: Trial Balance Reconciliation at Scale</h4>
                        <p>Processing 15M+ financial records while maintaining fundamental accounting principle: debits must equal credits at every aggregation level (document, account, period, entity).</p>
                    </div>
                    <div class="solution-item">
                        <h4>Solution</h4>
                        <p>Implemented automated validation framework in Databricks SQL checking debit/credit equality at bronze, silver, and gold layers. Built exception management workflow flagging discrepancies > $0.01 for immediate analyst review. Achieved 99.8% pass rate through rigorous data quality rules.</p>
                    </div>
                </div>

                <div class="challenge-solution">
                    <div class="challenge-item">
                        <h4>Challenge: False Positive Management</h4>
                        <p>Avoiding incorrect matches while catching true duplicates with fuzzy matching.</p>
                    </div>
                    <div class="solution-item">
                        <h4>Solution</h4>
                        <p>Developed weighted scoring system with configurable thresholds. Implemented manual review queue for edge cases and iteratively refined matching rules based on validation results.</p>
                    </div>
                </div>

                <div class="challenge-solution">
                    <div class="challenge-item">
                        <h4>Challenge: Salesforce Integration Complexity</h4>
                        <p>Coordinating updates to production CRM without disrupting business operations.</p>
                    </div>
                    <div class="solution-item">
                        <h4>Solution</h4>
                        <p>Developed strict COA mapping versioning in Databricks with change control approval workflow. Implemented A/B testing for new accounting rules on historical data before applying to production. Created comprehensive mapping documentation reviewed by target company CFOs and Signet's controllers.</p>
                    </div>
                </div>

                <div class="challenge-solution">
                    <div class="challenge-item">
                        <h4>Challenge: M&A Timeline Pressure</h4>
                        <p>Due diligence windows of 10-14 days requiring complete financial analysis, consolidation, and executive-ready reporting under extreme time constraints.</p>
                    </div>
                    <div class="solution-item">
                        <h4>Solution</h4>
                        <p>Created reusable Databricks notebook templates for common M&A workflows (GL extraction, COA mapping, trial balance validation, P&L generation). Built Power BI dashboard templates with pre-configured DAX measures for EBITDA, working capital, and KPIs. Reduced setup time per deal from 3 weeks to 2 days through automation.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Technologies Used -->
        <section class="case-section">
            <h2><i class="fas fa-tools"></i> Technologies & Tools</h2>
            
            <div class="tech-category">
                <h3>Data Platform & Cloud</h3>
                <div class="tech-badges">
                    <span class="tech-badge">Databricks</span>
                    <span class="tech-badge">Delta Lake</span>
                    <span class="tech-badge">Apache Spark</span>
                    <span class="tech-badge">Databricks SQL</span>
                    <span class="tech-badge">Azure Cloud</span>
                    <span class="tech-badge">Medallion Architecture</span>
                </div>
            </div>

            <div class="tech-category">
                <h3>Programming & Analytics</h3>
                <div class="tech-badges">
                    <span class="tech-badge">SQL (Advanced)</span>
                    <span class="tech-badge">PySpark</span>
                    <span class="tech-badge">Python</span>
                    <span class="tech-badge">Pandas</span>
                    <span class="tech-badge">NumPy</span>
                    <span class="tech-badge">Databricks Notebooks</span>
                </div>
            </div>

            <div class="tech-category">
                <h3>ERP Systems & Financial Applications</h3>
                <div class="tech-badges">
                    <span class="tech-badge">SAP FICO</span>
                    <span class="tech-badge">SAP RFC/BAPI</span>
                    <span class="tech-badge">Oracle Financials Cloud</span>
                    <span class="tech-badge">Oracle SQL*Net</span>
                    <span class="tech-badge">Kinergy Platform</span>
                    <span class="tech-badge">GAAP Accounting</span>
                </div>
            </div>

            <div class="tech-category">
                <h3>Reporting & Visualization</h3>
                <div class="tech-badges">
                    <span class="tech-badge">Power BI</span>
                    <span class="tech-badge">DAX</span>
                    <span class="tech-badge">Power Query</span>
                    <span class="tech-badge">DirectQuery</span>
                    <span class="tech-badge">Row-Level Security (RLS)</span>
                </div>
            </div>

            <div class="tech-category">
                <h3>Project Management & Collaboration</h3>
                <div class="tech-badges">
                    <span class="tech-badge">Jira</span>
                    <span class="tech-badge">Confluence</span>
                    <span class="tech-badge">Git</span>
                    <span class="tech-badge">Agile/Scrum</span>
                </div>
            </div>
        </section>

        <!-- Lessons Learned -->
        <section class="case-section">
            <h2><i class="fas fa-graduation-cap"></i> Key Learnings</h2>
            
            <ul class="learnings-list">
                <li><strong>Accounting Language Fluency Matters:</strong> Understanding GAAP principles, ASC accounting standards, and financial statement mechanics was as critical as technical Databricks skills. Can't automate what you don't understand financially.</li>
                
                <li><strong>Medallion Architecture Enables Audit Trail:</strong> Databricks bronze/silver/gold layers provided perfect structure for M&A work‚Äîraw ERP extracts in bronze (immutable), transformations in silver (auditable), consolidated financials in gold (reportable).</li>
                
                <li><strong>Chart of Accounts Mapping is 80% of the Battle:</strong> COA translation rules weren't just technical mapping‚Äîthey required understanding business context, accounting policies, and industry-specific GL structures. Every account tells a financial story.</li>
                
                <li><strong>Trial Balance Validation is Non-Negotiable:</strong> Debits must equal credits at EVERY aggregation level. A single $0.50 discrepancy can indicate systemic data quality issues worth millions. Automated validation caught errors humans would miss.</li>
                
                <li><strong>Financial Analysts Need Code + Accounting:</strong> The most valuable insight: hybrid skillset combining Python/SQL technical capabilities with deep accounting knowledge is rare and powerful. Can interrogate data AND understand what financial statements mean.</li>
                
                <li><strong>Power BI Dashboards Tell Financial Stories:</strong> M&A deal teams don't want tables of numbers‚Äîthey want visual narratives showing EBITDA trends, working capital movements, and acquisition impact scenarios. Databricks + Power BI combination enabled this.</li>
            </ul>

            <div class="analyst-note">
                <h4>The Lesson That Redefined My Career: Financial Analysts Who Code Have Superpowers</h4>
                <p>Here's the uncomfortable truth about M&A financial analysis: most accounting/finance professionals can read a P&L but can't extract it programmatically from SAP. Most data engineers can query databases but don't know the difference between accrual and cash basis accounting. I learned to be both. When a CFO asked, "Why does your EBITDA calculation differ from ours by $2.3M?", I didn't just show him the math‚ÄîI opened my Databricks notebook, filtered the silver layer GL transactions to account range 650000-659999 (depreciation), showed him our straight-line recalculation logic versus his accelerated method, and traced the $2.3M variance to 47 specific asset journal entries. He was speechless. That moment taught me: financial forensics requires accounting fluency + data interrogation skills. Databricks gave me the platform. Accounting knowledge gave me the questions to ask. Python gave me the tools to find answers buried in 15M GL records. The lesson: don't just learn to code. Learn to code financial logic. Learn to speak both languages‚ÄîSQL and GAAP. That combination makes you irreplaceable in M&A advisory work.</p>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="case-section conclusion">
            <h2>Conclusion</h2>
            <p>This M&A Financial Data Integration project demonstrated successful automation of complex financial consolidation processes, processing 15.2M+ general ledger records from heterogeneous ERP systems with 99.8% trial balance accuracy. The Databricks-based solution combined medallion architecture, Python-automated GL extraction, sophisticated chart of accounts mapping, and GAAP policy harmonization to deliver production-ready financial reporting in 5 days versus the prior 6-week manual process.</p>
            
            <p>The project showcased deep expertise in financial data engineering, ERP system integration (SAP FICO, Oracle Financials), accounting principles (GAAP, ASC 606/842), and M&A due diligence workflows while delivering $450M+ in successful transactions with $12.6M in identified financial discrepancies enabling price adjustments. The reusable Databricks framework now serves as Signet's standard platform for all Accounting Advisory M&A engagements, proving that financial analysts who combine accounting domain expertise with advanced data engineering create outsized business impact.</p>

            <div class="aha-moment">
                <h4>What I'd Tell My Past Self Before Starting This Project</h4>
                <p>If I could go back to day one, I'd tell myself three things. First: the "boring" decisions matter most. Distribution keys, sort keys, compression encoding‚ÄîI initially rushed through these as implementation details. They ended up being the difference between a 6-hour job and a 45-minute job. Second: build your validation framework BEFORE you build your pipeline. I did it in parallel and wished I'd done validation first‚Äîit would have caught design issues earlier. Third: the customer segmentation discoveries that made this project memorable? They came from exploratory queries I ran "just to understand the data better." Budget time for curiosity. The best insights in this project weren't in the requirements document‚Äîthey were in the questions I asked when no one was watching. Data tells stories. Make time to listen.</p>
            </div>
            
            <div class="cta-box">
                <h3>Interested in discussing similar challenges?</h3>
                <a href="index.html#contact" class="btn-cta">Get In Touch</a>
            </div>
        </section>
    </div>

    <footer class="case-footer">
        <div class="disclaimer">
            <p><i class="fas fa-shield-alt"></i> <strong>Disclaimer:</strong> This project presents composite scenarios and illustrative metrics based on professional experience. Specific numbers and examples are representative and do not reflect actual confidential data from any employer or client.</p>
        </div>
        <p>&copy; 2025 Pamela Austin. All rights reserved.</p>
        <a href="index.html">Back to Portfolio</a>
    </footer>

    <script src="script.js"></script>
</body>
</html>


